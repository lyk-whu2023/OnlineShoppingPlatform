import{g as M,d as $,u as F,c as j}from"./products-DzG9zYyj.js";import{g as D}from"./categories-YZVxBU0r.js";import{_ as E,r as f,o as L,c as w,b,a as l,w as a,d as u,f as y,h as r,t as S,F as T,e as q,g as G}from"./index-DGdkDIp8.js";import"./http-CBG7w8uf.js";const H={style:{"margin-bottom":"12px"}},J=["src"],K={class:"table-actions"},O={__name:"AdminProducts",setup(Q){const v=f([]),i=f(!1),o=f({id:null,name:"",categoryId:null,price:0,stock:0,description:""}),p=f([]);L(async()=>{await _();try{p.value=await D()}catch{p.value=[]}});async function _(){try{const n=await M({page:1,size:100});v.value=n.list||[]}catch{v.value=[]}}function g(n){return"https://picsum.photos/seed/"+(n.images&&n.images[0]||"p"+n.id)+"/120/80"}function V(n){const e=p.value.find(d=>d.id==n);return e?e.name:""}function k(){o.value={id:null,name:"",categoryId:null,price:0,stock:0,description:""},i.value=!0}function x(n){o.value={...n},i.value=!0}async function C(){try{o.value.id?await F(o.value.id,o.value):await j(o.value)}finally{i.value=!1,await _()}}async function I(n){try{await $(n)}finally{await _()}}return(n,e)=>{const d=u("el-button"),s=u("el-table-column"),P=u("el-table"),c=u("el-input"),m=u("el-form-item"),U=u("el-option"),B=u("el-select"),N=u("el-form"),z=u("el-dialog");return y(),w("div",null,[b("div",H,[l(d,{type:"primary",onClick:k},{default:a(()=>[...e[7]||(e[7]=[r("新增商品",-1)])]),_:1})]),l(P,{data:v.value,style:{width:"100%"}},{default:a(()=>[l(s,{label:"商品图",width:"120"},{default:a(t=>[b("img",{src:g(t.row),style:{width:"120px",height:"80px","object-fit":"cover"}},null,8,J)]),_:1}),l(s,{label:"名称",prop:"name"}),l(s,{label:"分类",width:"160"},{default:a(t=>[r(S(V(t.row.categoryId)),1)]),_:1}),l(s,{label:"单价",width:"120",prop:"price"}),l(s,{label:"库存",width:"120",prop:"stock"}),l(s,{label:"操作",width:"220"},{default:a(t=>[b("div",K,[l(d,{type:"primary",size:"small",onClick:A=>x(t.row)},{default:a(()=>[...e[8]||(e[8]=[r("编辑",-1)])]),_:1},8,["onClick"]),l(d,{type:"danger",size:"small",onClick:A=>I(t.row.id)},{default:a(()=>[...e[9]||(e[9]=[r("删除",-1)])]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"]),l(z,{title:"新增/编辑商品",modelValue:i.value,"onUpdate:modelValue":e[6]||(e[6]=t=>i.value=t),width:"600px"},{default:a(()=>[l(N,{"label-width":"100px"},{footer:a(()=>[l(d,{onClick:e[5]||(e[5]=t=>i.value=!1)},{default:a(()=>[...e[10]||(e[10]=[r("取消",-1)])]),_:1}),l(d,{type:"primary",onClick:C},{default:a(()=>[...e[11]||(e[11]=[r("保存",-1)])]),_:1})]),default:a(()=>[l(m,{label:"商品名称"},{default:a(()=>[l(c,{modelValue:o.value.name,"onUpdate:modelValue":e[0]||(e[0]=t=>o.value.name=t)},null,8,["modelValue"])]),_:1}),l(m,{label:"分类"},{default:a(()=>[l(B,{modelValue:o.value.categoryId,"onUpdate:modelValue":e[1]||(e[1]=t=>o.value.categoryId=t)},{default:a(()=>[(y(!0),w(T,null,q(p.value,t=>(y(),G(U,{label:t.name,value:t.id,key:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"价格"},{default:a(()=>[l(c,{modelValue:o.value.price,"onUpdate:modelValue":e[2]||(e[2]=t=>o.value.price=t),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1}),l(m,{label:"库存"},{default:a(()=>[l(c,{modelValue:o.value.stock,"onUpdate:modelValue":e[3]||(e[3]=t=>o.value.stock=t),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1}),l(m,{label:"描述"},{default:a(()=>[l(c,{type:"textarea",modelValue:o.value.description,"onUpdate:modelValue":e[4]||(e[4]=t=>o.value.description=t)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},Z=E(O,[["__scopeId","data-v-c84bd14c"]]);export{Z as default};
