# 前端接口文档（REST 提案）

- 基础地址：`http://localhost:8080/api`
- 依据后端数据结构（Mapper/DTO），为前端提供一致的 REST 接口层
- DTO 参考：
  - `ProductDTO`：`src/main/java/org/example/onlineshoppingplatform/dto/ProductDTO.java:7`
  - `CategoryDTO`：`src/main/java/org/example/onlineshoppingplatform/dto/CategoryDTO.java:4`
  - `UserDTO`：`src/main/java/org/example/onlineshoppingplatform/dto/UserDTO.java:6`
  - `OrderDTO`：`src/main/java/org/example/onlineshoppingplatform/dto/OrderDTO.java:8`
  - `OrderItemDTO`：`src/main/java/org/example/onlineshoppingplatform/dto/OrderItemDTO.java:6`
  - `AddressDTO`：`src/main/java/org/example/onlineshoppingplatform/dto/AddressDTO.java:6`
  - `ProductQueryDTO`：`src/main/java/org/example/onlineshoppingplatform/dto/ProductQueryDTO.java:6`
  - `PaymentDTO`：`src/main/java/org/example/onlineshoppingplatform/dto/PaymentDTO.java:6`
  - `ShipmentDTO`：`src/main/java/org/example/onlineshoppingplatform/dto/ShipmentDTO.java:6`

## 分类

- `GET /categories`
  - 响应：`CategoryDTO[]`
- `POST /categories`
  - 请求：`{ name }`
  - 响应：`CategoryDTO`
- `PUT /categories/{id}`、`DELETE /categories/{id}`

## 商品

- `GET /products`
  - 查询参数：`ProductQueryDTO`（`categoryId, keyword, minPrice, maxPrice, sort, page, size`）
  - 响应：`{ list: ProductDTO[], total, page, size }`
- `GET /products/{id}`
  - 响应：`ProductDTO`
- `GET /products/{id}/images`
  - 响应：`string[]`（图片 URL 或种子）
- `POST /products`
  - 请求：`ProductDTO`（不含 `id`，`images` 可选）
  - 响应：`ProductDTO`
- `PUT /products/{id}`、`DELETE /products/{id}`

## 用户与认证

- `POST /auth/login`
  - 请求：`{ username, password }`
  - 响应：`{ token, user: UserDTO }`
- `POST /auth/register`
  - 请求：`{ username, password, phone }`
  - 响应：`{ token, user: UserDTO }`
- `POST /auth/logout`
  - 响应：`204`
- `GET /users/me`
  - 响应：`UserDTO`
- 管理端：
  - `GET /users`
  - `PATCH /users/{id}/status`（`{ status }`）

## 地址

- `GET /addresses`
  - 查询参数：`userId`
  - 响应：`AddressDTO[]`
- `POST /addresses`
  - 请求：`AddressDTO`（不含 `id`）
  - 响应：`AddressDTO`
- `PUT /addresses/{id}`、`DELETE /addresses/{id}`

## 购物车

- `GET /cart`
  - 响应：`CartItemDTO[]`
- `POST /cart/items`
  - 请求：`CartItemDTO`
  - 响应：`CartItemDTO[]`
- `PUT /cart/items/{productId}`（更新数量）
  - 请求：`{ qty }`
  - 响应：`CartItemDTO[]`
- `DELETE /cart/items/{productId}`、`DELETE /cart`（清空）

## 订单

- `POST /orders`
  - 请求：`{ addressId }`（后端依据用户当前购物车创建）
  - 响应：`OrderDTO`
- `GET /orders/{id}`
  - 响应：`OrderDTO`
- `GET /orders`
  - 查询：`userId` 或 `status`
  - 响应：`OrderDTO[]`
- `PATCH /orders/{id}/status`
  - 请求：`{ status }`

## 支付

- `GET /payments/{orderId}`、`PUT /payments/{orderId}`
  - 请求：`PaymentDTO`
  - 响应：`PaymentDTO`

## 物流

- `GET /shipments/{orderId}`、`PUT /shipments/{orderId}`
  - 请求：`ShipmentDTO`
  - 响应：`ShipmentDTO`

## 错误约定

- 统一错误格式：`{ code, message, details? }`
- 常见状态码：
  - `400` 参数错误、`401` 未认证、`403` 无权限、`404` 资源不存在
  - `409` 冲突（库存不足等）、`500` 服务内部错误

## 与后端 Mapper 的对应

- 商品：`ProductMapper` 提供查询与增删改，参考 `src/main/java/org/example/onlineshoppingplatform/mapper/ProductMapper.java:10`
- 分类：`CategoryMapper`，参考 `src/main/java/org/example/onlineshoppingplatform/mapper/CategoryMapper.java:10`
- 订单与明细：`OrderMapper`、`OrderItemMapper`，参考 `src/main/java/org/example/onlineshoppingplatform/mapper/OrderMapper.java:10`
- 用户：`UserMapper`，参考 `src/main/java/org/example/onlineshoppingplatform/mapper/UserMapper.java:10`
- 地址：`AddressMapper`，参考 `src/main/java/org/example/onlineshoppingplatform/mapper/AddressMapper.java:10`
- 购物车：`CartMapper`、`CartItemMapper`
- 支付/物流：`PaymentMapper`、`ShipmentMapper`

> 注：当前仓库未包含 Controller 层。以上端点为前端消费的 API 设计提案，可据此实现后端控制器。
